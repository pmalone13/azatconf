{
	"$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
	"handler": "Microsoft.Azure.CreateUIDef",
	"version": "0.1.2-preview",
	"parameters": {
		"basics": [
            {
                "name": "releaseDate",
                "type": "Microsoft.Common.TextBlock",
                "visible": true,
                "options": {
                    "text": "Release Date: MARKETPLACE_RELEASE_DATE"
                }
            }
        ],
		"steps": [
			{

				"name": "administrator",
				"bladeTitle": "Configure Crowd",
				"label": "Configure Crowd",
				"subLabel": {
					"preValidation": "To do",
					"postValidation": "Done"
				},
				"elements": [
					{
                        "name": "crowdVersion",
                        "label": "Crowd Version",
                        "type": "Microsoft.Common.TextBox",
                        "toolTip": "Specify which version of Crowd you want to install. You can also specify 'latest' to download the latest version available.",
                        "constraints": {
                            "required": true,
                            "regex": "latest|^(\\d+)\\.(\\d+)\\.(\\d+)",
                            "validationMessage": "You must specify a version in decimal format. e.g 4.0.3"
                        },
                        "defaultValue": "4.0.0"
                    },
					{
						"name": "crowdClusterSize",
						"label": "Crowd Cluster",
						"type": "Microsoft.Common.DropDown",
						"toolTip": "Select from the drop down if you want to take Atlassian's recommended hardware configuration.",
						"constraints": {
							"allowedValues": [
								{
									"label": "Trial (Min HW)",
									"value": "trial"
								},
								{
									"label": "Small (25 Concurrent Users)",
									"value": "small"
								},
								{
									"label": "Medium (200 Concurrent Users)",
									"value": "medium"
								},
								{
									"label": "Large (600 Concurrent Users)",
									"value": "large"
								},
								{
									"label": "Enterprise (>2000 Concurrent Users)",
									"value": "enterprise"
								}
							],
							"required": true
						},
						"visible": true,
						"defaultValue": "Small (25 Concurrent Users)"
					},
					{
						"name": "trialClusterVmSize",
						"type": "Microsoft.Compute.SizeSelector",
						"label": "Selected Cluster Node VM Size",
						"toolTip": "Ensure that Recommended Cluster VM is applicable for your Azure Subscription.",
						"recommendedSizes": [
							"Standard_DS2_v2",
							"Standard_DS3_v2",
							"Standard_DS2",
							"Standard_DS3",
							"Standard_B4ms",
							"Standard_F2s",
							"Standard_F4s",
							"Standard_E4s_v3"
						],
						"constraints": {
							"allowedSizes": [
								"Standard_D4s_v3",
								"Standard_D8s_v3",
								"Standard_D16s_v3",
								"Standard_D32s_v3",
								"Standard_D64s_v3",
								"Standard_DS2_v2",
								"Standard_DS3_v2",
								"Standard_DS4_v2",
								"Standard_DS5_v2",
								"Standard_DS2",
								"Standard_DS3",
								"Standard_DS4",
								"Standard_B4ms",
								"Standard_B8ms",
								"Standard_F2s",
								"Standard_F4s",
								"Standard_F8s",
								"Standard_F16s",
								"Standard_E4s_v3",
								"Standard_E8s_v3",
								"Standard_E16s_v3",
								"Standard_E32s_v3",
								"Standard_E64s_v3",
								"Standard_GS2",
								"Standard_GS3",
								"Standard_GS4",
								"Standard_GS5",
								"Standard_DS12_v2",
								"Standard_DS13_v2",
								"Standard_DS14_v2",
								"Standard_DS15_v2",
								"Standard_DS12",
								"Standard_DS13",
								"Standard_DS14",
								"Standard_L4s",
								"Standard_L8s",
								"Standard_L16s",
								"Standard_L32s"
							]
						},
						"options": {
							"hideDiskTypeFilter": false
						},
						"osPlatform": "Linux",
						"imageReference": {
							"publisher": "Canonical",
							"offer": "UbuntuServer",
							"sku": "22.04-LTS"
						},
						"count": 1,
						"visible": "[equals('trial', steps('administrator').crowdClusterSize)]"
					},
					{
						"name": "smallClusterVmSize",
						"type": "Microsoft.Compute.SizeSelector",
						"label": "Selected Cluster Node VM Size",
						"toolTip": "Ensure that Recommended Cluster VM is applicable for your Azure Subscription.",
						"recommendedSizes": [
							"Standard_DS3_v2",
							"Standard_DS3",
							"Standard_D4s_v3",
							"Standard_B4ms",
							"Standard_B8ms",
							"Standard_F4s",
							"Standard_E4s_v3",
							"Standard_GS3",
							"Standard_L4s"
						],
						"constraints": {
							"allowedSizes": [
								"Standard_D4s_v3",
								"Standard_D8s_v3",
								"Standard_D16s_v3",
								"Standard_D32s_v3",
								"Standard_D64s_v3",
								"Standard_DS2_v2",
								"Standard_DS3_v2",
								"Standard_DS4_v2",
								"Standard_DS5_v2",
								"Standard_DS2",
								"Standard_DS3",
								"Standard_DS4",
								"Standard_B4ms",
								"Standard_B8ms",
								"Standard_F2s",
								"Standard_F4s",
								"Standard_F8s",
								"Standard_F16s",
								"Standard_E4s_v3",
								"Standard_E8s_v3",
								"Standard_E16s_v3",
								"Standard_E32s_v3",
								"Standard_E64s_v3",
								"Standard_GS2",
								"Standard_GS3",
								"Standard_GS4",
								"Standard_GS5",
								"Standard_DS12_v2",
								"Standard_DS13_v2",
								"Standard_DS14_v2",
								"Standard_DS15_v2",
								"Standard_DS12",
								"Standard_DS13",
								"Standard_DS14",
								"Standard_L4s",
								"Standard_L8s",
								"Standard_L16s",
								"Standard_L32s"
							]
						},
						"options": {
							"hideDiskTypeFilter": false
						},
						"osPlatform": "Linux",
						"imageReference": {
							"publisher": "Canonical",
							"offer": "UbuntuServer",
							"sku": "22.04-LTS"
						},
						"count": 1,
						"visible": "[equals('small', steps('administrator').crowdClusterSize)]"
					},
					{
						"name": "mediumClusterVmSize",
						"type": "Microsoft.Compute.SizeSelector",
						"label": "Selected Cluster Node VM Size",
						"toolTip": "Ensure that Recommended Cluster VM is applicable for your Azure Subscription.",
						"recommendedSizes": [
							"Standard_DS3_v2",
							"Standard_DS3",
							"Standard_B4ms",
							"Standard_F4s",
							"Standard_E4s_v3",
							"Standard_GS3",
							"Standard_L4s",
							"Standard_DS4_v2",
							"Standard_DS4",
							"Standard_B8ms",
							"Standard_F8s"
						],
						"constraints": {
							"allowedSizes": [
								"Standard_D4s_v3",
								"Standard_D8s_v3",
								"Standard_D16s_v3",
								"Standard_D32s_v3",
								"Standard_D64s_v3",
								"Standard_DS2_v2",
								"Standard_DS3_v2",
								"Standard_DS4_v2",
								"Standard_DS5_v2",
								"Standard_DS2",
								"Standard_DS3",
								"Standard_DS4",
								"Standard_B4ms",
								"Standard_B8ms",
								"Standard_F2s",
								"Standard_F4s",
								"Standard_F8s",
								"Standard_F16s",
								"Standard_E4s_v3",
								"Standard_E8s_v3",
								"Standard_E16s_v3",
								"Standard_E32s_v3",
								"Standard_E64s_v3",
								"Standard_GS2",
								"Standard_GS3",
								"Standard_GS4",
								"Standard_GS5",
								"Standard_DS12_v2",
								"Standard_DS13_v2",
								"Standard_DS14_v2",
								"Standard_DS15_v2",
								"Standard_DS12",
								"Standard_DS13",
								"Standard_DS14",
								"Standard_L4s",
								"Standard_L8s",
								"Standard_L16s",
								"Standard_L32s"
							]
						},
						"options": {
							"hideDiskTypeFilter": false
						},
						"osPlatform": "Linux",
						"imageReference": {
							"publisher": "Canonical",
							"offer": "UbuntuServer",
							"sku": "22.04-LTS"
						},
						"count": 1,
						"visible": "[equals('medium', steps('administrator').crowdClusterSize)]"
					},
					{
						"name": "largeClusterVmSize",
						"type": "Microsoft.Compute.SizeSelector",
						"label": "Selected Cluster Node VM Size",
						"toolTip": "Ensure that Recommended Cluster VM is applicable for your Azure Subscription.",
						"recommendedSizes": [
							"Standard_D4s_v3",
							"Standard_DS4",
							"Standard_DS4_v2",
							"Standard_B4ms",
							"Standard_F4s",
							"Standard_GS4",
							"Standard_L4s",
							"Standard_E4s_v3",
							"Standard_L8s",
							"Standard_D8s_v3",
							"Standard_B8ms",
							"Standard_F8s",
							"Standard_E8s_v3",
							"Standard_GS5",
							"Standard_D16s_v3",
							"Standard_D32s_v3",
							"Standard_D64s_v3",
							"Standard_DS5_v2",
							"Standard_F16s",
							"Standard_E16s_v3",
							"Standard_E32s_v3",
							"Standard_E64s_v3",
							"Standard_DS12_v2",
							"Standard_DS13_v2",
							"Standard_DS14_v2",
							"Standard_DS15_v2",
							"Standard_DS12",
							"Standard_DS13",
							"Standard_DS14",
							"Standard_L16s",
							"Standard_L32s"
						],
						"constraints": {
							"allowedSizes": [
								"Standard_D4s_v3",
								"Standard_D8s_v3",
								"Standard_D16s_v3",
								"Standard_D32s_v3",
								"Standard_D64s_v3",
								"Standard_DS2_v2",
								"Standard_DS3_v2",
								"Standard_DS4_v2",
								"Standard_DS5_v2",
								"Standard_DS2",
								"Standard_DS3",
								"Standard_DS4",
								"Standard_B4ms",
								"Standard_B8ms",
								"Standard_F2s",
								"Standard_F4s",
								"Standard_F8s",
								"Standard_F16s",
								"Standard_E4s_v3",
								"Standard_E8s_v3",
								"Standard_E16s_v3",
								"Standard_E32s_v3",
								"Standard_E64s_v3",
								"Standard_GS2",
								"Standard_GS3",
								"Standard_GS4",
								"Standard_GS5",
								"Standard_DS12_v2",
								"Standard_DS13_v2",
								"Standard_DS14_v2",
								"Standard_DS15_v2",
								"Standard_DS12",
								"Standard_DS13",
								"Standard_DS14",
								"Standard_L4s",
								"Standard_L8s",
								"Standard_L16s",
								"Standard_L32s"
							]
						},
						"options": {
							"hideDiskTypeFilter": false
						},
						"osPlatform": "Linux",
						"imageReference": {
							"publisher": "Canonical",
							"offer": "UbuntuServer",
							"sku": "22.04-LTS"
						},
						"count": 1,
						"visible": "[equals('large', steps('administrator').crowdClusterSize)]"
					},
					{
						"name": "enterpriseClusterVmSize",
						"type": "Microsoft.Compute.SizeSelector",
						"label": "Selected Cluster Node VM Size",
						"toolTip": "Ensure that Recommended Cluster VM is applicable for your Azure Subscription.",
						"recommendedSizes": [
							"Standard_DS5_v2",
							"Standard_L8s",
							"Standard_D8s_v3",
							"Standard_B8ms",
							"Standard_F8s",
							"Standard_E8s_v3",
							"Standard_GS5",
							"Standard_D16s_v3",
							"Standard_D32s_v3",
							"Standard_D64s_v3",
							"Standard_DS5_v2",
							"Standard_F16s",
							"Standard_E16s_v3",
							"Standard_E32s_v3",
							"Standard_E64s_v3",
							"Standard_DS12_v2",
							"Standard_DS13_v2",
							"Standard_DS14_v2",
							"Standard_DS15_v2",
							"Standard_DS12",
							"Standard_DS13",
							"Standard_DS14",
							"Standard_L16s",
							"Standard_L32s"
						],
						"constraints": {
							"allowedSizes": [
								"Standard_D4s_v3",
								"Standard_D8s_v3",
								"Standard_D16s_v3",
								"Standard_D32s_v3",
								"Standard_D64s_v3",
								"Standard_DS2_v2",
								"Standard_DS3_v2",
								"Standard_DS4_v2",
								"Standard_DS5_v2",
								"Standard_DS2",
								"Standard_DS3",
								"Standard_DS4",
								"Standard_B4ms",
								"Standard_B8ms",
								"Standard_F2s",
								"Standard_F4s",
								"Standard_F8s",
								"Standard_F16s",
								"Standard_E4s_v3",
								"Standard_E8s_v3",
								"Standard_E16s_v3",
								"Standard_E32s_v3",
								"Standard_E64s_v3",
								"Standard_GS2",
								"Standard_GS3",
								"Standard_GS4",
								"Standard_GS5",
								"Standard_DS12_v2",
								"Standard_DS13_v2",
								"Standard_DS14_v2",
								"Standard_DS15_v2",
								"Standard_DS12",
								"Standard_DS13",
								"Standard_DS14",
								"Standard_L4s",
								"Standard_L8s",
								"Standard_L16s",
								"Standard_L32s"
							]
						},
						"options": {
							"hideDiskTypeFilter": false
						},
						"osPlatform": "Linux",
						"imageReference": {
							"publisher": "Canonical",
							"offer": "UbuntuServer",
							"sku": "22.04-LTS"
						},
						"count": 1,
						"visible": "[equals('enterprise', steps('administrator').crowdClusterSize)]"
					}
				]
			},
			{
                "name": "database",
                "bladeTitle": "Configure Database",
                "label": "Configure Database",
                "subLabel": {
                    "preValidation": "To do",
                    "postValidation": "Done"
                },
                "elements": [
                    {
                        "name": "dbType",
                        "label": "Database Type",
                        "type": "Microsoft.Common.OptionsGroup",
                        "defaultValue": "Azure SQL DB",
                        "toolTip": "The database type.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Azure SQL DB",
                                    "value": "Azure SQL DB"
                                },
                                {
                                    "label": "Azure DB for PostgreSQL",
                                    "value": "Azure DB for PostgreSQL"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "dbUsername",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Database Username",
                        "toolTip": "The username for the dedicated database user.",
                        "defaultValue": "",
                        "constraints": {
                            "required": true,
                            "regex": "^(?!admin$|administrator$|sa$|root$|dbmanager$|loginmanager$|dbo$|guest$|information_schema$|sys$|db_accessadmin$|db_backupoperator$|db_datareader$|db_datawriter$|db_ddladmin$|db_denydatareader$|db_denydatawriter$|db_owner$|db_securityadmin$|public$)[a-zA-Z][a-zA-Z0-9]{1,9}$",
                            "validationMessage": "This username needs to be a SQL Identifier - it can't be a typical username like admin, adminstrator, sa, root, dbmanager, loginmanager, dbo, guest, or public. It also can't begin with numbers or symbols, and can't include whitespaces, unicode characters, or non-alphabetic characters."
                        }
                    },
                    {
                        "name": "dbPassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "toolTip": "The password for the dedicated database user.",
                        "label": {
                            "password": "Database Password",
                            "confirmPassword": "Confirm Database Password"
                        },
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[!@#$%*])(?=.*[0-9])(?=.*[a-z]).{12,16}$",
                            "validationMessage": "This password must be between 12 and 16 characters long, and must contain at least one uppercase letter, one lowercase letter, one number (0-9), and one of the following non-alphanumeric character [!, @, #, $, %, *]."
                        }
                    }
                ]
            },
			{
				"name": "ssh",
				"bladeTitle": "Configure SSH Access",
				"label": "Configure SSH Access",
				"subLabel": {
					"preValidation": "To do",
					"postValidation": "Done"
				},
				"elements": [
					{
						"name": "nodeSshSection",
						"label": "Setup SSH Access to the Crowd Nodes",
						"type": "Microsoft.Common.Section",
						"elements": [
							{
								"name": "nodeUsername",
								"label": "Node SSH Username",
								"defaultValue": "",
								"type": "Microsoft.Compute.UserNameTextBox",
								"toolTip": "The SSH username to use to access the Crowd nodes from the Jumpbox. Note that this is the only way to access the Crowd nodes.",
								"constraints": {
									"required": true,
									"validationMessage": "You must specify a username."
								},
								"osPlatform": "Linux"
							}
						]
					},
					{
						"name": "jumpboxSshSection",
						"label": "Setup SSH Access to the Jumpbox",
						"type": "Microsoft.Common.Section",
						"elements": [
							{
								"name": "sshKey",
								"type": "Microsoft.Compute.CredentialsCombo",
								"label": {
									"authenticationType": "Authentication type",
									"password": "Password",
									"confirmPassword": "Confirm password",
									"sshPublicKey": "Jumpbox SSH Public Key"
								},
								"toolTip": {
									"authenticationType": "Authentication Type",
									"password": "Password",
									"sshPublicKey": "SSH Public Key"
								},
								"constraints": {
									"required": true
								},
								"options": {
									"hideConfirmation": false,
									"hidePassword": true
								},
								"osPlatform": "Linux",
								"visible": true
							}
						]
					}
				]
			},
			{
				"name": "domain",
				"bladeTitle": "Configure Domain",
				"label": "Configure Domain",
				"subLabel": {
					"preValidation": "To do",
					"postValidation": "Done"
				},
				"elements": [
					{
						"name": "cnameSection",
						"label": "Set up Domain",
						"type": "Microsoft.Common.Section",
						"elements": [
							{
								"name": "hascname",
								"type": "Microsoft.Common.OptionsGroup",
								"label": "Do you have an existing registered CNAME?",
								"toolTip": "If you provide one, the deployment will be made available from crowd.<CNAME> URL eg crowd.domain.com. If you don't, Azure will generate a random domain for your deployment endpoint.",
								"defaultValue": "No",
								"constraints": {
									"allowedValues": [
										{
											"label": "Yes",
											"value": "yes"
										},
										{
											"label": "No",
											"value": "no"
										}
									],
									"required": true
								}
							},
							{
								"name": "cname",
								"label": "Existing CNAME",
								"type": "Microsoft.Common.TextBox",
								"toolTip": "The CNAME or domain name for your organization",
								"constraints": {
									"required": true,
									"regex": ".+\\..+",
									"validationMessage": "You must specify a valid domain name eg domain.com"
								},
								"visible": "[equals('yes', steps('domain').cnameSection.hascname)]"
							}
						]
					},
					{
						"name": "sslSection",
						"label": "Set up HTTPS/SSL",
						"type": "Microsoft.Common.Section",
						"elements": [
							{
								"name": "hasssl",
								"type": "Microsoft.Common.OptionsGroup",
								"label": "Do you want to use SSL?",
								"toolTip": "If you have a SSL PFX certificate and password, you can enter it here to setup HTTPS/SSL.",
								"defaultValue": "No",
								"constraints": {
									"allowedValues": [
										{
											"label": "Yes",
											"value": "yes"
										},
										{
											"label": "No",
											"value": "no"
										}
									],
									"required": true
								}
							},
							{
								"name": "sslBase64EncodedPfxCertificate",
								"type": "Microsoft.Common.TextBox",
								"label": "Base64 Encoded PFX Certificate",
								"toolTip": "The certificate to be used for SSL termination on the Azure Application Gateway.",
								"constraints": {
									"required": true,
									"regex": "^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$",
									"validationMessage": "Expected a Base64-encoded certificate"
								},
								"visible": "[equals('yes', steps('domain').sslSection.hasssl)]"
							},
							{
								"name": "sslPfxCertificatePassword",
								"type": "Microsoft.Common.PasswordBox",
								"label": {
									"password": "Certificate Password",
									"confirmPassword": "Confirm Certificate Password"
								},
								"toolTip": "The certificate password to be used for SSL termination on the Azure Application Gateway.",
								"constraints": {
									"required": true,
									"validationMessage": "You must specify a password."
								},
								"visible": "[equals('yes', steps('domain').sslSection.hasssl)]"
							}
						]
					}
				]
			},
			{
				"name": "monitoring",
				"bladeTitle": "Configure Monitoring",
				"label": "Configure Monitoring",
				"subLabel": {
					"preValidation": "To do",
					"postValidation": "Done"
				},
				"elements": [
                    {
                        "name": "locationInfo",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "[concat('Location: ', location())]"
                        }
                    },
                    {
                        "name": "enableEmailAlerts",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Email Alerts",
                        "defaultValue": "Yes",
                        "toolTip": "Enable Email Alerts.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": true
                                },
                                {
                                    "label": "No",
                                    "value": false
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
					{
						"name": "adminEmail",
						"label": "Alerts Email",
						"type": "Microsoft.Common.TextBox",
						"toolTip": "The email address to which system alerts will be sent.",
						"constraints": {
							"required": false,
							"regex": "[^@]+@[^@]+\\.[A-z]{2,4}",
							"validationMessage": "You must specify an email address."
						},
						"visible": "[steps('monitoring').enableEmailAlerts]"
					},
                    {
                        "name": "enableAppInsights",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Application Insights",
                        "defaultValue": "Yes",
                        "toolTip": "Enable Azure Application Insights.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": true
                                },
                                {
                                    "label": "No",
                                    "value": false
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "appInsightsCheck",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": "[and(steps('monitoring').enableAppInsights,  not(contains('australiaeast, australiasoutheast, canadacentral, centralus, eastasia, eastus, eastus2, japaneast, koreacentral, northcentralus, northeurope, southcentralus, southeastasia, uksouth, westeurope, westus, westus2', location())))]",
                        "options": {
                            "icon": "Error",
                            "text": "App Insights product only available in regions: australiaeast, australiasoutheast, canadacentral, centralus, eastasia, eastus, eastus2, japaneast, koreacentral, northcentralus, northeurope, southcentralus, southeastasia, uksouth, westeurope, westus, westus2. Please disable or change resource group location!",
                            "uri": "https://azure.microsoft.com/en-gb/global-infrastructure/services/?products=monitor&regions=us-east,us-east-2,us-central,us-north-central,us-south-central,us-west-central,us-west,us-west-2,canada-east,canada-central,non-regional,europe-north,europe-west,france-central,france-south,united-kingdom-south,united-kingdom-west,asia-pacific-east,asia-pacific-southeast,australia-central,australia-central-2,australia-east,australia-southeast,germany-non-regional,germany-central,germany-northeast,usgov-non-regional,us-dod-central,us-dod-east,usgov-arizona,usgov-iowa,usgov-texas,usgov-virginia,brazil-south,japan-east,japan-west,central-india,south-india,west-india,korea-central,korea-south"
                        }
                    },
                    {
                        "name": "enableAnalytics",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Enable Azure Analytics for Application Gateway and Azure SQL Database",
                        "defaultValue": "No",
                        "toolTip": "Enable Azure Analytics for Application Gateway and Azure SQL Database.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": true
                                },
                                {
                                    "label": "No",
                                    "value": false
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "workspaceSku",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Configure Log Analytics Workspace Pricing Tier",
                        "defaultValue": "Per GB (New Subscription Tier)",
                        "toolTip": "Select Log Analytics Workspace SKU. Options depend on your Azure Subscription. If you have an Azure subscription greater in 2018 or later, use Per GB. If created before, use Free to start with.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Per GB (New Subscription Tier)",
                                    "value": "PerGB2018"
                                },
                                {
                                    "label": "Free (Old Subscription Tier)",
                                    "value": "Free"
                                },
                                {
                                    "label": "Per Node (Old Subscription Tier)",
                                    "value": "PerNode"
                                },
                                {
                                    "label": "Standalone (Old Subscription Tier)",
                                    "value": "Standalone"
                                },
                                {
                                    "label": "Standard (Old Subscription Tier)",
                                    "value": "Standard"
                                },
                                {
                                    "label": "Premium (Old Subscription Tier)",
                                    "value": "Premium"
                                },
                                {
                                    "label": "Unlimited (Old Subscription Tier)",
                                    "value": "Unlimited"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "appAnalyticsCheck",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": "[and(steps('monitoring').enableAnalytics, not(contains('australiaeast, australiasoutheast, canadacentral, centralus, eastasia, eastus, eastus2, japaneast, koreacentral, northcentralus, northeurope, southcentralus, southeastasia, uksouth, westeurope, westus, westus2', location())))]",
                        "options": {
                            "icon": "Error",
                            "text": "Analytics products only available in regions: australiaeast, australiasoutheast, canadacentral, centralus, eastasia, eastus, eastus2, japaneast, koreacentral, northcentralus, northeurope, southcentralus, southeastasia, uksouth, westeurope, westus, westus2. Please disable or change resource group location!",
                            "uri": "https://azure.microsoft.com/en-gb/global-infrastructure/services/?products=monitor&regions=us-east,us-east-2,us-central,us-north-central,us-south-central,us-west-central,us-west,us-west-2,canada-east,canada-central,non-regional,europe-north,europe-west,france-central,france-south,united-kingdom-south,united-kingdom-west,asia-pacific-east,asia-pacific-southeast,australia-central,australia-central-2,australia-east,australia-southeast,germany-non-regional,germany-central,germany-northeast,usgov-non-regional,us-dod-central,us-dod-east,usgov-arizona,usgov-iowa,usgov-texas,usgov-virginia,brazil-south,japan-east,japan-west,central-india,south-india,west-india,korea-central,korea-south"
                        }
                    },
                    {
                        "name": "postgresAnalyticsCheck",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": "[and(steps('monitoring').enableAnalytics, equals(steps('database').dbType, 'Azure DB for PostgreSQL'))]",
                        "options": {
                            "icon": "Info",
                            "text": "Azure SQL Analytics not currently available for PostgreSQL!"
                        }
                    }
                ]
			}
		],
		"outputs": {
			"location": "[location()]",
			"isMarketplaceDeployment": true,
			"crowdVersion": "[steps('administrator').crowdVersion]",
			"crowdClusterSize": "[steps('administrator').crowdClusterSize]",
			"clusterVmSize": "[coalesce(steps('administrator').trialClusterVmSize, steps('administrator').smallClusterVmSize, steps('administrator').mediumClusterVmSize, steps('administrator').largeClusterVmSize, steps('administrator').enterpriseClusterVmSize)]",
            "dbUsername": "[steps('database').dbUsername]",
            "dbPassword": "[steps('database').dbPassword]",
            "dbType": "[steps('database').dbType]",
			"sshKey": "[steps('ssh').jumpboxSshSection.sshKey.sshPublicKey]",
			"sshUserName": "[steps('ssh').nodeSshSection.nodeUsername]",
			"cname": "[steps('domain').cnameSection.cname]",
			"sslBase64EncodedPfxCertificate": "[steps('domain').sslSection.sslBase64EncodedPfxCertificate]",
			"sslPfxCertificatePassword": "[steps('domain').sslSection.sslPfxCertificatePassword]",
			"enableEmailAlerts": "[steps('monitoring').enableEmailAlerts]",
			"crowdAdminUserEmail": "[steps('monitoring').adminEmail]",
			"enableApplicationInsights": "[steps('monitoring').enableAppInsights]",
            "enableAnalytics": "[steps('monitoring').enableAnalytics]",
            "workspaceSku": "[steps('monitoring').workspaceSku]"
		}
	}
}